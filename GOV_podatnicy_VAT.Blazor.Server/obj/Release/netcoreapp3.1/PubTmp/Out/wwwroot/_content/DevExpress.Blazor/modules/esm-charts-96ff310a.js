import"./esm-chunk-d81494b9.js";import"./esm-chunk-a2731447.js";import{ensureElement as e,elementHasCssClass as t,changeDom as n,calculateStyles as o,getCurrentStyle as i,getAbsoluteX as r,getAbsoluteY as c,toggleCssClass as l}from"./esm-dom-utils-aa188e06.js";import{a as s}from"./esm-chunk-9c16a801.js";import{p as u,t as a}from"./esm-chunk-365cd234.js";class d{constructor(e,t){this.widget=t,this.chartElement=d.getChartElement(e)}static getChartElement(e){return e.querySelector(".dx-chart")}}const f=new Map;function p(e){const t=f.get(e);return void 0===t?Promise.reject():t.widget}function g(e,t,n){const o=f.get(e);if(void 0===o||o.chartElement!==d.getChartElement(e)){const o=function(e,t,n){return new Promise((function(o){import("./esm-devexpress.viz-5d8db4bd.js").then((function(i){const r=m(i,d.getChartElement(e),t,o);n(t,r)}))}))}(e,t,n);return f.set(e,new d(e,o)),o}return o.widget.then((function(e){return new Promise((function(o){n(t,(function(t){t.animation={enabled:!1},e.option(t),o("ok")}))}))})).catch(window.console.error)}function m(e,t,n,o){const i=n.series.map(e=>e.category)[0],r="pie"===i||"donut"===i?e.viz.dxPieChart:e.viz.dxChart;return function(e){e.type=i,o(new r(t,e))}}function h(e,t,n,o,i,r){i.forEach((function(i){s(e,i,(function(e){const i=v(t,n,o);i&&r(i)}))}))}function v(e,t,n){let o=e.getSeriesByPos(t);return n&&(o=o.getPoints().filter((function(e){return e.tag===n}))[0]),o}function w(e,n,o,i,r){if(!e)return;const c=v(n,o,i);if(!c)return;const l=e.querySelector(".dx-chart-legend-icon");if(l){const e=c.getColor();t(l,"dx-chart-def-icon")&&(l.style.backgroundColor=e),l.style.color=e}r||(h(e,n,o,i,["mouseover","focusin"],(function(e){e.hover(n.option("legend.hoverMode"))})),h(e,n,o,i,["mouseout","focusout"],(function(e){e.clearHover()})))}let y;function b(t,o){o&&y&&y.clearHover();const i=(t=e(t)).querySelector(".dx-chart-tooltip");i&&n(()=>i.classList.remove("show"))}function x(e,t){return e._valueAxes.filter((function(e){return e.pane===t.name}))[0]}const S={init:function(e,t,d){const f=window.getComputedStyle(document.body).getPropertyValue("color");return g(e,t,(function(t,p){!function(e,t){if(e.palette)return t(e.palette);const r=["bg-primary","bg-success","bg-danger","bg-warning","bg-info","bg-secondary"],c=document.createElement("DIV");c.className="d-none position-absolute";for(let e=0;e<r.length;e++){const t=document.createElement("DIV");t.className=r[e],c.appendChild(t)}n((function(){document.body.appendChild(c),o((function(){const e=[];for(let t=0;t<c.childNodes.length;t++)e.push(i(c.childNodes[t]).backgroundColor);n((function(){document.body.removeChild(c),t(e)}))}))}))}(t,(function(i){let g=!1;const m={tooltip:t.tooltip,dataSource:t.dataSource,palette:i,rotated:t.rotated,resolveLabelOverlapping:t.labelOverlap,size:t.size,commonAxisSettings:{label:{overlappingBehavior:"rotate",rotationAngle:45,font:{color:f,opacity:.75}}},dataPrepareSettings:{sortingMethod:!1},commonSeriesSettings:{argumentField:"argument",valueField:"value",openValueField:"openValue",highValueField:"highValue",lowValueField:"lowValue",closeValueField:"closeValue",rangeValue1Field:"startValue",rangeValue2Field:"endValue",sizeField:"size",type:"bar"},adaptiveLayout:{width:0,height:0},seriesTemplate:{nameField:"seriesId",customizeSeries:function(e){return t.series.filter((function(t){return t.seriesId===e}))[0]}},customizeLabel:function(e){return e.data.pointLabel},customizePoint:function(e){return e.data.pointAppearance},legend:{visible:!1,hoverMode:(t.legend?t.legend.hoverMode:null)||"includepoints"},onDrawn:function(t){g||(g=!0,function(e,t){const n=e.querySelectorAll(".dx-chart-legend-item");for(let e=0;e<n.length;e++){const o=n[e],i=+o.getAttribute("data-series"),r=o.getAttribute("data-point");w(o,t,i,r,!0)}}(e,t.component),function(e,t){function i(e,t){n((function(){a(e,0,t)}))}function r(e,t,n,o,r){i(e,o),e.marginTop="-"+r+"px",i(t,-r),i(n,-r)}t.panes&&0!==t.panes.filter((function(e){return"default"!==e.name})).length&&o((function(){let o=0;for(let n=t.panes.length-2;n>=0;n--){const c=t.panes[n],l=e.querySelector(".dx-chart-legend[data-pane='"+c.name+"']");if(l){const e=l.offsetHeight+o,n=x(t,c),s=n._axisGroup.element,a=n._axisGridGroup.element,d=a.getBoundingClientRect().bottom+10,f=u(l.style),p=l.getBoundingClientRect().top-f.top;t.series.filter((function(e){return e.pane===c.name})).forEach((function(t){i(t._group.element.style,-e)})),r(l.style,s.style,a.style,d-p,e),o+=e}}n((function(){t.option("margin",{top:o})}))}))}(e,t.component),l(e,"dx-loading",!1))},valueAxis:t.valueAxis,panes:t.panes,argumentAxis:t.argumentAxis,pathModified:!0};if(t.tooltip&&t.tooltip.enabled){!function(e,t,o){e.tooltip={enabled:!1,forceEvents:!0,location:t.location},e.onTooltipHidden=function(e){const t=e.target;t&&t.tag&&t.series&&(y===t&&b(e.element.closest("div.dx-blazor-widget"),!1),y=null)},e.onTooltipShown=function(e){const t=e.target;t&&o.invokeMethodAsync("ShowTooltip",t.tag,t.series.index).then((function(){const o=e.element.closest("div.dx-blazor-widget"),i=o.querySelector(".dx-chart-tooltip"),l=i.offsetParent,s=e.element.getBoundingClientRect(),u=o.getBoundingClientRect(),a=(u.width+s.width)/2,d=s.left-u.left,f=i.getBoundingClientRect().width/2;let p=e.x-r(l),g=0;p+f>a?(g=p+f-a,p=a-f):p-f<d&&(g=p-f-d,p=f+d);const m=i.querySelector(".dx-tooltip-pointer"),h=`calc(${e.y-c(l)}px - 0.625rem)`,v=i.classList;n((function(){i.style.top=h,i.style.left=p+"px",m.style.left=`calc(50% + ${g}px)`,v.contains("show")||v.add("show")})),y=t}))}}(m,t.tooltip,d);const o=e.querySelector(".dx-chart-legend");o&&s(o,"mouseover",(function(t){b(e,!0)}))}p(m)}))})).then((function(){return Promise.resolve("ok")})).catch((function(e){window.console.error(e)}))},dispose:function(t){if(t=e(t))return function(t,n){t=e(t);const o=f.get(t);return void 0!==o&&(o.chartElement=null,o.widget=null,n&&f.delete(t)),Promise.resolve("ok")}(t,!0)},onSeriesLegendElementReceived:function(e,t,n,o){return p(e).then((function(e){return w(o,e,t,n),Promise.resolve()})).catch((function(e){window.console.error(e)}))},onSeriesVisibleChanged:function(e,t,n,o){return p(e).then((function(e){const i=v(e,t,n);return o?i.show():i.hide(),Promise.resolve()})).catch((function(e){window.console.error(e)}))}};export default S;export{m as createWidgetBuilder};
